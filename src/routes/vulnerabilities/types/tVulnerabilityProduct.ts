import { useTemplate } from '@/utils/template'
import { uid } from 'uid'

export type TVulnerabilityProduct = {
  id: string
  productId: string
  versions: string[]
  status: TProductStatus | ''
}

// Not all statuses are used in the UI, but they are defined here for completeness
export const productStatus = [
  'first_affected',
  'known_affected',
  'known_not_affected',
  'last_affected',
  'first_fixed',
  'fixed',
  'recommended',
  'under_investigation',
] as const

export type TProductStatus = (typeof productStatus)[number]

export function useVulnerabilityProductGenerator(): TVulnerabilityProduct {
  const { getTemplateDefaultObject } = useTemplate()
  const defaultProduct = getTemplateDefaultObject<TVulnerabilityProduct>(
    'vulnerabilities.products',
  )

  return {
    id: uid(),
    productId: '',
    versions: [],
    status: defaultProduct.status || '',
  }
}
