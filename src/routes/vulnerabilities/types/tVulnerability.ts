import { TNote } from '@/routes/shared/NotesList'
import { uid } from 'uid'
import { TVulnerabilityProduct } from './tVulnerabilityProduct'
import { TVulnerabilityScore } from './tVulnerabilityScore'
import { TRemediation } from './tRemediation'
import { TVulnerabilityFlag } from './tVulnerabilityFlag'

export type TCwe = {
  id: string
  name: string
}

export type TVulnerability = {
  id: string
  cve?: string
  cwe?: TCwe
  title: string
  notes: TNote[]
  products: TVulnerabilityProduct[]
  flags: TVulnerabilityFlag[]
  remediations: TRemediation[]
  scores: TVulnerabilityScore[]
}

export function getDefaultVulnerability(): TVulnerability {
  return {
    id: uid(),
    title: '',
    notes: [] as TNote[],
    products: [] as TVulnerabilityProduct[],
    flags: [] as TVulnerabilityFlag[],
    remediations: [] as TRemediation[],
    scores: [] as TVulnerabilityScore[],
  }
}
